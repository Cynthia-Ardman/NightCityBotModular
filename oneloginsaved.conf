copy { src = 'raw_event_data', dest = 'onelogin.audit' }
set { dest = 'appomni.service.type', value = 'onelogin' }
# https://developers.onelogin.com/api-docs/1/events/get-events

# event_type_id to event_type_name
# Mappings from GET https://appomnidev.onelogin.com/api/1/events/types
translate {
    src = 'raw_event_data.event_type_id'
    dest = 'event.code'
    default = 'unknown'
    map = {
        '1' = 'APP_ADDED_TO_ROLE'
        '2' = 'APP_REMOVED_FROM_ROLE'
        '3' = 'USER_ASSUMED_USER'
        '4' = 'USER_ASSIGNED_ROLE'
        '5' = 'USER_LOGGED_INTO_ONELOGIN'
        '6' = 'USER_FAILED_ONELOGIN_LOGIN'
        '7' = 'USER_LOGGED_OUT_OF_ONELOGIN'
        '8' = 'USER_LOGGED_INTO_APP'
        '9' = 'USER_FAILED_APP_LOGIN'
        '10' = 'USER_REQUESTED_NEW_PASSWORD'
        '11' = 'USER_CHANGED_PASSWORD'
        '12' = 'UNLOCKED_USER'
        '13' = 'CREATED_USER'
        '14' = 'UPDATED_USER'
        '15' = 'DEACTIVATED_USER'
        '16' = 'ACTIVATED_USER'
        '17' = 'DELETED_USER'
        '18' = 'ADMIN_APPROVED_PASSWORD_REQUEST'
        '19' = 'USER_LOCKED'
        '20' = 'REACHED_USERS_LIMIT'
        '21' = 'SUSPENDED_USER'
        '22' = 'USER_ADDED_OTP_DEVICE'
        '23' = 'USER_BULK_OPERATION'
        '24' = 'USER_REMOVED_OTP_DEVICE'
        '25' = 'PROVISIONING_EXCEPTION'
        '26' = 'PROVISIONING_EVENT'
        '27' = 'USER_DOWNLOADED_CERT'
        '28' = 'USER_RECENTLY_REMOVED'
        '29' = 'USER_LOGGED_OUT_OF_APP'
        '30' = 'UPDATED_PAYMENT_INFO'
        '31' = 'FAILED_UPDATE_PAYMENT_INFO'
        '32' = 'REACTIVATED_USER'
        '33' = 'USERS_IMPORTED_FROM_DIRECTORY'
        '34' = 'USER_REQUESTED_APP'
        '35' = 'USER_LOCKED_OUT_OF_APP'
        '36' = 'USER_LOST_OTP_DEVICE'
        '37' = 'USER_JOIN_REQUEST'
        '38' = 'APP_REACHED_USER_LIMIT'
        '39' = 'CONNECTOR_BROKEN'
        '40' = 'USER_UNLOCKED_OTP_DEVICE'
        '41' = 'AD_CONNECTOR_STARTED'
        '42' = 'AD_CONNECTOR_STOPPED'
        '43' = 'AD_CONNECTOR_CONFIG_RELOAD'
        '44' = 'AD_CONNECTOR_NOTIFICATION'
        '45' = 'AD_CONNECTOR_EXCEPTION_OLD'
        '46' = 'AD_CONNECTOR_FAIL_OVER'
        '47' = 'AD_CONNECTOR_EXCEPTION'
        '48' = 'IMPORTED_USER'
        '49' = 'UPDATE_USER_FAILED'
        '50' = 'REJECTED_USER'
        '51' = 'USER_CREATED_IN_APP'
        '52' = 'USER_UPDATED_IN_APP'
        '53' = 'USER_SUSPENDED_IN_APP'
        '54' = 'USER_REACTIVATED_IN_APP'
        '55' = 'USER_DELETED_IN_APP'
        '56' = 'UNMATCHED_USERS'
        '57' = 'RABBIT_DOWN'
        '58' = 'RABBIT_RESTARTED'
        '59' = 'USER_LINKED_IN_APP'
        '60' = 'PROVISIONING_DEPROVISIONING_MODE_DO_NOTHING_WARNING'
        '61' = 'USER_FAILED_SUSPENDING_IN_APP'
        '62' = 'USER_FAILED_REACTIVATING_IN_APP'
        '63' = 'USER_FAILED_DELETING_IN_APP'
        '64' = 'USER_FAILED_CREATING_IN_APP'
        '65' = 'USER_FAILED_UPDATING_IN_APP'
        '66' = 'NO_USERS_TO_IMPORT_FROM_DIRECTORY'
        '67' = 'DIRECTORY_IMPORT_EXCEPTION'
        '68' = 'USER_AUTHENTICATED_BY_RADIUS'
        '69' = 'USER_REJECTED_BY_RADIUS'
        '70' = 'PRIVILEGE_GRANTED_TO_ACCOUNT'
        '71' = 'PRIVILEGE_REVOKED_FROM_ACCOUNT'
        '72' = 'PRIVILEGE_GRANTED_TO_USER'
        '73' = 'PRIVILEGE_REVOKED_FROM_USER'
        '74' = 'TRUSTED_IDP_ADDED'
        '75' = 'TRUSTED_IDP_REMOVED'
        '76' = 'TRUSTED_IDP_MODIFIED'
        '77' = 'USER_FAILED_PROXY_LOGIN'
        '78' = 'USER_SUCCEEDED_PROXY_LOGIN'
        '79' = 'AD_CONNECTOR_PROVISIONING_ERROR'
        '80' = 'USER_CREATED_IN_DIRECTORY'
        '81' = 'USER_UPDATED_IN_DIRECTORY'
        '82' = 'USER_SUSPENDED_IN_DIRECTORY'
        '83' = 'USER_REACTIVATED_IN_DIRECTORY'
        '84' = 'USER_DELETED_IN_DIRECTORY'
        '85' = 'APP_COULD_NOT_AUTHENTICATE'
        '86' = 'USER_FAILED_REMOTE_AUTHENTICATION'
        '87' = 'USER_VIEWED_NOTE'
        '88' = 'USER_EDITED_NOTE'
        '89' = 'USER_DELETED_NOTE'
        '90' = 'USER_UNAUTHORIZED_APP_ACCESS'
        '91' = 'USER_UNDETERMINED_BY_RADIUS'
        '92' = 'USER_NTHASH_REQUESTED_BY_RADIUS'
        '95' = 'DIRECTORY_GROUPS_WRITE_BACK_IMPORT_STARTED'
        '96' = 'DIRECTORY_GROUPS_WRITE_BACK_IMPORT_FINISHED'
        '100' = 'SELF_REGISTRATION_REQUEST'
        '101' = 'SELF_REGISTRATION_APPROVED'
        '102' = 'SELF_REGISTRATION_DENIED'
        '103' = 'SELF_REGISTRATION_REQUEST_UNVERIFIED'
        '104' = 'SELF_REGISTRATION_REQUEST_VERIFIED'
        '105' = 'SMS_FAILURE'
        '106' = 'USER_CHANGE_PASSWORD_FAILED'
        '110' = 'APP_LOGINS_UPDATED'
        '111' = 'APP_LOGINS_UPDATE_FAILED'
        '112' = 'TRUSTED_IDP_MADE_DEFAULT'
        '113' = 'DIRECTORY_IMPORT_STARTED'
        '114' = 'DIRECTORY_IMPORT_FINISHED'
        '115' = 'USER_INVITED'
        '116' = 'CREATE_USER_FAILED'
        '117' = 'DIRECTORY_SYNC_RUN_ID'
        '118' = 'SAML_ACS_FAILED'
        '119' = 'TRUSTED_IDP_REMOVED_AS_DEFAULT'
        '120' = 'UNLOCKED_USER_IN_DIRECTORY'
        '121' = 'SCRIPTLET_ERROR'
        '122' = 'USER_AUTHENTICATED_BY_API'
        '123' = 'USER_REJECTED_BY_API'
        '124' = 'ENTITLEMENTS_CACHE_ACTION'
        '125' = 'ENTITLEMENT_ACTION'
        '126' = 'DIRECTORY_CONNECTOR_ENABLED'
        '127' = 'DIRECTORY_CONNECTOR_DISABLED'
        '128' = 'NO_ACTIVE_ACTIVE_DIRECTORY_CONNECTORS'
        '129' = 'VLDAP_BIND_FAILURE'
        '130' = 'VLDAP_BIND_SUCCESS'
        '131' = 'DIRECTORY_EXPORT_STARTED'
        '132' = 'DIRECTORY_EXPORT_FINISHED'
        '133' = 'DIRECTORY_EXPORT_EXCEPTION'
        '134' = 'DIRECTORY_REFRESH_SCHEMA_EXCEPTION'
        '135' = 'CERTIFICATE_EXPIRES'
        '136' = 'DIRECTORY_FIELDS_IMPORT_STARTED'
        '137' = 'USER_APP_REQUEST_APPROVED'
        '138' = 'USER_APP_REQUEST_DENIED'
        '139' = 'DIRECTORY_FIELDS_IMPORT_FINISHED'
        '140' = 'SOCIAL_SIGN_IN'
        '141' = 'SOCIAL_SIGN_IN_FAILURE'
        '145' = 'USER_SMART_PASSWORD_UPDATED'
        '146' = 'USER_SMART_PASSWORD_UPDATE_FAILED'
        '147' = 'USER_MANUALLY_ADDED_TO_ROLE'
        '148' = 'USER_MANUALLY_REMOVED_FROM_ROLE'
        '149' = 'USER_AUTO_ADDED_TO_ROLE'
        '150' = 'USER_AUTO_REMOVED_FROM_ROLE'
        '151' = 'USER_ROLE_MANAGEMENT_GRANTED'
        '152' = 'USER_ROLE_MANAGEMENT_REVOKED'
        '153' = 'MAC_LOGIN_SUCCESS'
        '154' = 'MAC_LOGIN_FAILURE'
        '155' = 'DIRECTORY_FIELDS_IMPORT_EXCEPTION'
        '156' = 'POLICY_CREATED'
        '157' = 'POLICY_UPDATED'
        '158' = 'POLICY_DELETED'
        '159' = 'PROXY_AGENT_CREATED'
        '160' = 'PROXY_AGENT_DELETED'
        '161' = 'RADIUS_CONFIG_CREATED'
        '162' = 'RADIUS_CONFIG_UPDATED'
        '163' = 'RADIUS_CONFIG_DELETED'
        '164' = 'VPN_ENABLED'
        '165' = 'VPN_SETTINGS_UPDATED'
        '166' = 'VPN_DISABLED'
        '167' = 'EMBEDDING_ENABLED'
        '168' = 'EMBEDDING_SETTINGS_UPDATED'
        '169' = 'EMBEDDING_DISABLED'
        '170' = 'AUTHENTICATION_FACTOR_CREATED'
        '171' = 'AUTHENTICATION_FACTOR_UPDATED'
        '172' = 'AUTHENTICATION_FACTOR_DELETED'
        '173' = 'SECURITY_QUESTIONS_UPDATED'
        '174' = 'DESKTOP_SSO_SETTINGS_UPDATED'
        '175' = 'DESKTOP_SSO_ENABLED'
        '176' = 'DESKTOP_SSO_DISABLED'
        '177' = 'CERTIFICATE_CREATED'
        '178' = 'CERTIFICATE_DELETED'
        '179' = 'API_CREDENTIAL_CREATED'
        '180' = 'API_CREDENTIAL_DELETED'
        '181' = 'API_CREDENTIAL_ENABLED'
        '182' = 'API_CREDENTIAL_DISABLED'
        '183' = 'VLDAP_ENABLED'
        '184' = 'VLDAP_DISABLED'
        '185' = 'VLDAP_SETTINGS_UPDATED'
        '186' = 'BRANDING_ENABLED'
        '187' = 'BRANDING_DISABLED'
        '188' = 'BRANDING_UPDATED'
        '189' = 'MAPPING_ADDED'
        '190' = 'MAPPING_DELETED'
        '191' = 'MAPPING_DISABLED'
        '192' = 'MAPPING_ENABLED'
        '193' = 'MAPPING_UPDATED'
        '194' = 'USER_FIELD_ADDED'
        '195' = 'USER_FIELD_DELETED'
        '196' = 'COMPANY_INFO_UPDATED'
        '197' = 'ACCOUNT_SETTINGS_UPDATED'
        '198' = 'DIRECTORY_CREATED'
        '199' = 'DIRECTORY_DESTROYED'
        '200' = 'DIRECTORY_CONNECTOR_INSTANCE_ADDED'
        '201' = 'DIRECTORY_CONNECTOR_INSTANCE_DELETED'
        '202' = 'REAPPLIED_MAPPINGS'
        '203' = 'SELF_REGISTRATION_PROFILE_CREATED'
        '204' = 'SELF_REGISTRATION_PROFILE_UPDATED'
        '205' = 'SELF_REGISTRATION_PROFILE_DESTROYED'
        '206' = 'MANUALLY_ADDED_LOGIN'
        '207' = 'MANUALLY_REMOVED_LOGIN'
        '208' = 'RETRIED_PROVISIONING'
        '209' = 'DIRECTORY_USER_IMPORT_WARNING'
        '210' = 'LDAP_CONNECTOR_EXCEPTION'
        '211' = 'ADMIN_CHANGED_USER_PASSWORD'
        '212' = 'DIRECTORY_LOCKED'
        '213' = 'PROFILE_PICTURE_UPLOADED'
        '214' = 'PROFILE_PICTURE_DELETED'
        '215' = 'ADMIN_CHANGED_ACCOUNT_SETTINGS'
        '216' = 'JOB_IN_QUEUE'
        '217' = 'DIRECTORY_IMPORT_LIMIT_REACHED'
        '218' = 'REAPPLIED_MAPPINGS_FAILED'
        '219' = 'WORKDAY_REAL_TIME_NOTIFICATION'
        '220' = 'ADMIN_CREATED_PAYMENT_RECORD'
        '221' = 'ADMIN_UPDATED_PAYMENT_RECORD'
        '222' = 'ADMIN_DELETED_PAYMENT_RECORD'
        '223' = 'USER_UNLICENSED'
        '224' = 'USER_LICENSED_MANUALLY'
        '225' = 'USER_UNLICENSED_MANUALLY'
        '226' = 'USER_UNLICENSED_AUTOMATICALLY'
        '227' = 'USER_LICENSE_FAILED'
        '228' = 'USERS_LICENSED_BULK'
        '229' = 'ACCOUNT_NEAR_LIMIT'
        '230' = 'ACCOUNT_IN_LIMIT'
        '231' = 'USERS_IN_UNLICENSED_STATE'
        '232' = 'USER_AGREED_TERMS'
        '233' = 'USER_DENIED_TERMS'
        '234' = 'ADMIN_ENABLED_TERMS'
        '235' = 'ADMIN_UPDATED_TERMS'
        '236' = 'ADMIN_DISABLED_TERMS'
        '237' = 'DELETE_USER_FAILED'
        '238' = 'USER_REDIRECTED_FOR_PASSWORD_CHANGE'
        '239' = 'IMPORT_USER_FAILED'
        '240' = 'USER_REVEALED_PASSWORD'
        '241' = 'CSV_IMPORT_FAILED'
        '242' = 'JOB_START_FAILED'
        '243' = 'JOB_TERMINATED'
        '244' = 'REPORT_GENERATED'
        '245' = 'REPORT_GENERATION_FAILED'
        '246' = 'REPORT_GENERATION_TERMINATED'
        '247' = 'USER_MAPPINGS_FAILED'
        '248' = 'USER_MAPPINGS_SUCCEEDED'
        '249' = 'USER_BULK_OPERATION_FAILED'
        '250' = 'PROVISIONING_APP_CONFIG_ERROR'
        '251' = 'PROVISIONING_APP_THROTTLED'
        '252' = 'USER_REMOVELOGINS_FAILED'
        '253' = 'ENTITLEMENT_MAPPINGS_FAILED'
        '254' = 'ENTITLEMENT_MAPPINGS_REAPPLIED'
        '255' = 'MANUALLY_UPDATED_LOGIN'
        '291' = 'USER_CREATED_BY_TIDP'
        '300' = 'LDAP_CONNECTOR_STARTED'
        '301' = 'LDAP_CONNECTOR_NOTIFICATION'
        '303' = 'LDAP_CONNECTOR_CONFIG_RELOAD'
        '304' = 'LDAP_CONNECTOR_STOPPED'
        '305' = 'LDAP_CONNECTOR_FAIL_OVER'
        '306' = 'MANUALLY_ADDED_LOGIN_FAILURE'
        '307' = 'LDAP_CONNECTOR_PROVISIONING_ERROR'
        '330' = 'USER_DISASSOCIATED_FROM_DIRECTORY'
        '331' = 'USER_ASSOCIATED_TO_DIRECTORY'
        '332' = 'USER_DIRECTORY_EXTERNAL_ID_UPDATED'
        '333' = 'USER_DIRECTORY_EXTERNAL_ID_DELETED'
        '334' = 'USER_NOT_UPDATED_IN_APP'
        '400' = 'API_BAD_REQUEST'
        '401' = 'API_UNAUTHORIZED'
        '402' = 'MAPPING_SKIPPED'
        '410' = 'BROADCASTER_CREATED'
        '411' = 'BROADCASTER_UPDATED'
        '412' = 'BROADCASTER_DELETED'
        '501' = 'API_INDEX_ACTION'
        '502' = 'API_SHOW_ACTION'
        '503' = 'API_RES_ACTION'
        '510' = 'API_SET_PWD_SALT'
        '511' = 'API_SET_PWD_CLEAR_TEXT'
        '512' = 'API_SET_CUSTOM_ATTRS'
        '513' = 'API_ADD_ROLES'
        '514' = 'API_REMOVE_ROLES'
        '515' = 'API_AUTH_ISSUE_TOKEN'
        '516' = 'API_LOGOUT'
        '517' = 'API_SET_PWD_SALT_FAILED'
        '518' = 'API_SET_PWD_CLEAR_TEXT_FAILED'
        '519' = 'API_SET_CUSTOM_ATTRS_FAILED'
        '520' = 'API_ADD_ROLES_FAILED'
        '521' = 'API_REMOVE_ROLES_FAILED'
        '522' = 'API_AUTH_ISSUE_TOKEN_FAILED'
        '523' = 'API_LOGOUT_FAILED'
        '524' = 'API_DESTROY_USER_FAILED'
        '525' = 'API_GET_INVITE_LINK_FAILED'
        '526' = 'API_LOCK_USER_FAILED'
        '527' = 'API_VERIFY_FACTOR_FAILED'
        '528' = 'API_VERIFY_FACTOR'
        '529' = 'API_UPDATE_USER'
        '530' = 'API_DESTROY_USER'
        '531' = 'API_LOCK_USER'
        '532' = 'API_UPDATE_USER_FAILED'
        '533' = 'API_CREATE_USER'
        '534' = 'API_CREATE_USER_FAILED'
        '535' = 'API_GET_INVITE_LINK'
        '536' = 'API_USER_OTPS_RETRIEVED'
        '537' = 'API_CONFIRM_FACTOR'
        '538' = 'API_CONFIRM_FACTOR_FAILED'
        '539' = 'API_TRIGGER_FACTOR'
        '540' = 'API_ADDED_OTP_DEVICE'
        '541' = 'DIRECTORY_UPDATED'
        '542' = 'DIRECTORY_OUS_CHANGED'
        '545' = 'API_SEND_INVITE_LINK_FAILED'
        '546' = 'API_SEND_INVITE_LINK'
        '550' = 'FORCE_LOGOUT_USER'
        '551' = 'SUSPENDED_USER_VIA_API'
        '552' = 'REACTIVATED_USER_VIA_API'
        '553' = 'USER_LOCKED_VIA_API'
        '554' = 'UNLOCKED_USER_VIA_API'
        '555' = 'EXTERNAL_ASSUME_USER'
        '600' = 'APP_CREATED_BY_USER'
        '601' = 'APP_UPDATED_BY_USER'
        '602' = 'APP_DELETED_BY_USER'
        '700' = 'CONNECTOR_CREATED'
        '701' = 'CONNECTOR_CREATE_FAILED'
        '702' = 'CONNECTOR_UPDATED'
        '703' = 'CONNECTOR_UPDATE_FAILED'
        '704' = 'CONNECTOR_DELETED'
        '705' = 'CONNECTOR_DELETE_FAILED'
        '706' = 'CONNECTOR_STATS_UPDATE'
        '800' = 'PARAMETER_CREATED'
        '801' = 'PARAMETER_CREATE_FAILED'
        '802' = 'PARAMETER_UPDATED'
        '803' = 'PARAMETER_UPDATE_FAILED'
        '804' = 'PARAMETER_DELETED'
        '805' = 'PARAMETER_DELETE_FAILED'
        '900' = 'ONELOGIN_DESKTOP_MAC_LOGIN_SUCCESS'
        '901' = 'ONELOGIN_DESKTOP_MAC_LOGIN_FAILURE'
        '902' = 'ONELOGIN_DESKTOP_DEVICE_DELETED'
        '903' = 'ONELOGIN_DESKTOP_DEVICE_UNBIND'
        '904' = 'ONELOGIN_DESKTOP_LOGIN_SUCCESS'
        '905' = 'ONELOGIN_DESKTOP_LOGIN_FAILURE'
        '906' = 'ONELOGIN_DESKTOP_USER_FAILED_ONELOGIN_LOGIN'
        '907' = 'DIRECTORY_EXPORT_SUCCESS'
        '911' = 'ONELOGIN_DESKTOP_REVOKE_CERT_FOR_USER'
        '912' = 'ONELOGIN_DESKTOP_REVOKE_CERT_FOR_DEVICE'
        '931' = 'ADAPTIVE_LOGIN_ENABLED'
        '932' = 'ADAPTIVE_LOGIN_DISABLED'
        '950' = 'OL_OTP_PUSH_REJECT'
        '1001' = 'USER_LOGIN_CHALLENGE'
        '1002' = 'USER_LOGIN_CHALLENGE_FAILED'
        '1010' = 'USER_REAUTH_SUCCESS'
        '1100' = 'TEMP_OTP_TOKEN_GENERATED'
        '1101' = 'TEMP_OTP_TOKEN_REVOKED'
        '1200' = 'DELEGATED_APP_PRIVILEGE_DENIED'
        '1201' = 'DELEGATED_USER_PRIVILEGE_DENIED'
        '1244' = 'USER_ADDED_PHONE_NUMBER'
        '1245' = 'USER_UPDATED_PHONE_NUMBER'
        '1300' = 'API_APP_CREATED'
        '1301' = 'API_APP_CREATE_FAILED'
        '1302' = 'API_APP_UPDATED'
        '1303' = 'API_APP_UPDATE_FAILED'
        '1304' = 'API_APP_DESTROYED'
        '1305' = 'API_APP_DESTROY_FAILED'
        '1400' = 'USER_VERIFIED_OTP_DEVICE'
        '1401' = 'API_AUTH_APP_CREATE_FAILED'
        '1402' = 'API_AUTH_APP_UPDATED'
        '1403' = 'API_AUTH_APP_UPDATE_FAILED'
        '1404' = 'API_AUTH_APP_DESTROYED'
        '1405' = 'API_AUTH_APP_DESTROY_FAILED'
        '1406' = 'API_AUTH_SCOPE_CREATED'
        '1407' = 'API_AUTH_SCOPE_CREATE_FAILED'
        '1408' = 'API_AUTH_SCOPE_UPDATED'
        '1409' = 'API_AUTH_SCOPE_UPDATE_FAILED'
        '1410' = 'API_AUTH_SCOPE_DESTROYED'
        '1411' = 'API_AUTH_SCOPE_DESTROY_FAILED'
        '1412' = 'API_AUTH_CLAIM_CREATED'
        '1413' = 'API_AUTH_CLAIM_CREATE_FAILED'
        '1414' = 'API_AUTH_CLAIM_UPDATED'
        '1415' = 'API_AUTH_CLAIM_UPDATE_FAILED'
        '1416' = 'API_AUTH_CLAIM_DESTROYED'
        '1417' = 'API_AUTH_CLAIM_DESTROY_FAILED'
        '1418' = 'API_AUTH_CLIENT_CREATED'
        '1419' = 'API_AUTH_CLIENT_CREATE_FAILED'
        '1420' = 'API_AUTH_CLIENT_UPDATED'
        '1421' = 'API_AUTH_CLIENT_UPDATE_FAILED'
        '1422' = 'API_AUTH_CLIENT_DESTROYED'
        '1423' = 'API_AUTH_CLIENT_DESTROY_FAILED'
        '1424' = 'API_AUTH_APP_CREATED'
        '1500' = 'SANDBOX_SYNC_STARTED'
        '1501' = 'SANDBOX_SYNC_FAILED'
        '1502' = 'SANDBOX_SYNCED'
        '1503' = 'SANDBOX_DELETED'
        '1504' = 'SANDBOX_DELETE_FAILED'
        '1505' = 'SANDBOX_CREATED'
        '1506' = 'SANDBOX_CREATION_FAILED'
        '1507' = 'SANDBOX_UPDATED'
        '1508' = 'SANDBOX_UPDATE_FAILED'
        '1509' = 'SANDBOX_DELETED_BY_API'
        '1510' = 'SANDBOX_DELETE_FAILED_BY_API'
        '1511' = 'SANDBOX_CREATED_BY_API'
        '1512' = 'SANDBOX_CREATION_FAILED_BY_API'
        '1513' = 'SANDBOX_UPDATED_BY_API'
        '1514' = 'SANDBOX_UPDATE_FAILED_BY_API'
        '1600' = 'PROFILE_DEVICES_DELETE_DEVICE'
        '1601' = 'PROFILE_DEVICES_RENAME_DEVICE'
        '1602' = 'PROFILE_DEVICES_UPDATE_DEFAULT'
        '1603' = 'PROFILE_SETTINGS_UPDATE_LOCALE'
        '1604' = 'PROFILE_SETTINGS_UPDATE_PHONE'
        '1605' = 'PROFILE_SETTINGS_UPDATE_DEFAULT_TAB'
        '1606' = 'PROFILE_SETTINGS_UPDATE_PROFILE_PHOTO'
        '1607' = 'PROFILE_SETTINGS_UPDATE_APP_AUTO_DETECT'
        '1608' = 'PROFILE_CHANGE_PASSWORD'
        '1609' = 'PROFILE_SETTINGS_UPDATE_SHOW_TABS'
        '1700' = 'RADIUS_ATTRIBUTE_CREATED'
        '1701' = 'RADIUS_ATTRIBUTE_UPDATED'
        '1702' = 'RADIUS_ATTRIBUTE_DELETED'
        '1801' = 'ROLE_CREATED'
        '1802' = 'ROLE_DELETED'
        '1900' = 'API_BRAND_CREATED'
        '1901' = 'API_BRAND_CREATE_FAILED'
        '1902' = 'API_BRAND_UPDATED'
        '1903' = 'API_BRAND_UPDATE_FAILED'
        '1904' = 'API_BRAND_DESTROYED'
        '1905' = 'API_BRAND_DESTROY_FAILED'
        '2000' = 'HOOKS_LIST_FUNCTION'
        '2001' = 'CUSTOM_SMTP_ERROR'
        '2002' = 'SMTP_SETTINGS_UPDATED'
        '2003' = 'HOOKS_CREATE_FUNCTION'
        '2004' = 'HOOKS_CREATE_FUNCTION_FAILED'
        '2005' = 'HOOKS_GET_FUNCTION'
        '2006' = 'HOOKS_GET_FUNCTION_LOGS'
        '2007' = 'HOOKS_UPDATE_FUNCTION'
        '2008' = 'HOOKS_UPDATE_FUNCTION_FAILED'
        '2009' = 'HOOKS_DELETE_FUNCTION'
        '2010' = 'HOOKS_DELETE_FUNCTION_FAILED'
        '2011' = 'HOOKS_LIST_ENVVAR'
        '2012' = 'HOOKS_CREATE_ENVVAR'
        '2013' = 'HOOKS_CREATE_ENVVAR_FAILED'
        '2014' = 'HOOKS_GET_ENVVAR'
        '2015' = 'HOOKS_UPDATE_ENVVAR'
        '2016' = 'HOOKS_UPDATE_ENVVAR_FAILED'
        '2017' = 'HOOKS_DELETE_ENVVAR'
        '2018' = 'HOOKS_DELETE_ENVVAR_FAILED'
        '2100' = 'DELEGATED_PRIVILEGE_CREATED_VIA_API'
        '2101' = 'DELEGATED_PRIVILEGE_CREATED_BY_USER'
        '2102' = 'DELEGATED_PRIVILEGE_UPDATED_VIA_API'
        '2103' = 'DELEGATED_PRIVILEGE_UPDATED_BY_USER'
        '2104' = 'DELEGATED_PRIVILEGE_DELETED_VIA_API'
        '2105' = 'DELEGATED_PRIVILEGE_DELETED_BY_USER'
        '2106' = 'DELEGATED_PRIVILEGE_ASSIGNED_TO_USER_VIA_API'
        '2107' = 'DELEGATED_PRIVILEGE_ASSIGNED_TO_USER_BY_USER'
        '2108' = 'DELEGATED_PRIVILEGE_REMOVED_FROM_USER_VIA_API'
        '2109' = 'DELEGATED_PRIVILEGE_REMOVED_FROM_USER_BY_USER'
        '2110' = 'DELEGATED_PRIVILEGE_ASSIGNED_TO_ROLE_VIA_API'
        '2111' = 'DELEGATED_PRIVILEGE_ASSIGNED_TO_ROLE_BY_USER'
        '2112' = 'DELEGATED_PRIVILEGE_REMOVED_FROM_ROLE_VIA_API'
        '2113' = 'DELEGATED_PRIVILEGE_REMOVED_FROM_ROLE_BY_USER'
        '2114' = 'DELEGATED_ROLE_PRIVILEGE_DENIED'
        '2201' = 'REPORT_CREATED_BY_USER'
        '2202' = 'REPORT_UPDATED_BY_USER'
        '2203' = 'REPORT_CLONED_BY_USER'
        '2204' = 'REPORT_DESTROYED_BY_USER'
        '3000' = 'OIDC_GENERAL_FAIL'
        '3001' = 'OIDC_IMPLICIT_FLOW_SUCCESS'
        '3002' = 'OIDC_IMPLICIT_FLOW_FAILED'
        '3003' = 'OIDC_GET_CODE_SUCCESS'
        '3004' = 'OIDC_GET_CODE_FAILED'
        '3005' = 'OIDC_AUTHORIZATION_CODE_SUCCESS'
        '3006' = 'OIDC_AUTHORIZATION_CODE_FAILED'
        '3007' = 'OIDC_CLIENT_CREDENTIALS_SUCCESS'
        '3008' = 'OIDC_CLIENT_CREDENTIALS_FAILED'
        '3009' = 'OIDC_PASSWORD_SUCCESS'
        '3010' = 'OIDC_PASSWORD_FAILED'
        '3011' = 'OIDC_REFRESH_TOKEN_SUCCESS'
        '3012' = 'OIDC_REFRESH_TOKEN_FAILED'
        '3013' = 'OIDC_VALIDATE_TOKEN_SUCCESS'
        '3014' = 'OIDC_VALIDATE_TOKEN_FAILED'
        '3015' = 'OIDC_REVOKE_TOKEN_SUCCESS'
        '3016' = 'OIDC_REVOKE_TOKEN_FAILED'
        '3017' = 'OIDC_USER_INFO_SUCCESS'
        '3018' = 'OIDC_USER_INFO_FAILED'
        '3019' = 'NOTIFICATION_WAS_SENT'
        '3020' = 'GROUP_CREATED'
        '3021' = 'GROUP_UPDATED'
        '3022' = 'GROUP_DESTROYED'
        '3023' = 'USER_CREATED_NOTE'
        '3024' = 'DELEGATED_GROUP_PRIVILEGE_DENIED'
        '3025' = 'DELEGATED_POLICY_PRIVILEGE_DENIED'
        '3026' = 'PROFILE_DEVICES_UNSET_DEFAULT'
        '3027' = 'DELEGATED_REPORT_PRIVILEGE_DENIED'
        '3028' = 'DELEGATED_TRUSTED_IDP_PRIVILEGE_DENIED'
        '9000' = 'USER_ENABLED_WORKFLOW'
        '9001' = 'USER_DISABLED_WORKFLOW'
        '9002' = 'USER_INITIATED_WORKFLOW'
        '9003' = 'USER_COMPLETED_TASK'
        '9004' = 'USER_MARKED_TASK_COMPLETE'
        '9005' = 'USER_MARKED_WORKFLOW_COMPLETE'
        '9006' = 'USER_MARKED_TASK_INCOMPLETE'
        '9007' = 'USER_ENABLED_ONBOARDING'
        '9008' = 'USER_DISABLED_ONBOARDING'
        '9009' = 'USER_ENABLED_OFFBOARDING'
        '9010' = 'USER_DISABLED_OFFBOARDING'
        '9011' = 'USER_INITIATED_OFFBOARDING'
        '9012' = 'USER_INITIATED_ONBOARDING'
        '9013' = 'USER_COMPLETED_WORKFLOW'
        '9014' = 'APP_RULES_LIST_SUCCESS'
        '9015' = 'APP_RULES_LIST_FAILED'
        '9016' = 'APP_RULES_CREATE_SUCCESS'
        '9017' = 'APP_RULES_CREATE_FAILED'
        '9018' = 'APP_RULES_UPDATE_SUCCESS'
        '9019' = 'APP_RULES_UPDATE_FAILED'
        '9020' = 'APP_RULES_GET_SUCCESS'
        '9021' = 'APP_RULES_GET_FAILED'
        '9022' = 'APP_RULES_DRYRUN_SUCCESS'
        '9023' = 'APP_RULES_DRYRUN_FAILED'
        '9024' = 'APP_RULES_DELETE_SUCCESS'
        '9025' = 'APP_RULES_DELETE_FAILED'
        '9026' = 'APP_RULES_SORT_SUCCESS'
        '9027' = 'APP_RULES_SORT_FAILED'
        '9028' = 'APP_RULES_APPLY_SUCCESS'
        '9029' = 'APP_RULES_APPLY_FAILED'
        '9030' = 'APP_RULES_REFRESH_ENTITLEMENTS_SUCCESS'
        '9031' = 'APP_RULES_REFRESH_ENTITLEMENTS_FAILED'
        '9032' = 'APP_RULES_LIST_CONDITIONS_SUCCESS'
        '9033' = 'APP_RULES_LIST_CONDITIONS_FAILED'
        '9034' = 'APP_RULES_LIST_CONDITION_OPERATORS_SUCCESS'
        '9035' = 'APP_RULES_LIST_CONDITION_OPERATORS_FAILED'
        '9036' = 'APP_RULES_LIST_ACTIONS_SUCCESS'
        '9037' = 'APP_RULES_LIST_ACTIONS_FAILED'
        '9038' = 'APP_RULES_LIST_ACTION_VALUES_SUCCESS'
        '9039' = 'APP_RULES_LIST_ACTION_VALUES_FAILED'
        '9040' = 'USER_ROLE_MANAGEMENT_GRANTED_FAILED'
        '9041' = 'USER_ROLE_MANAGEMENT_REVOKED_FAILED'
        '9042' = 'APP_ADDED_TO_ROLE_FAILED'
        '9043' = 'APP_REMOVED_FROM_ROLE_FAILED'
        '9044' = 'USER_MANUALLY_ADDED_TO_ROLE_FAILED'
        '9045' = 'USER_MANUALLY_REMOVED_FROM_ROLE_FAILED'
        '9046' = 'ROLE_CREATE_FAILED'
        '9047' = 'ROLE_DELETE_FAILED'
        '9048' = 'ROLE_LIST_SUCCESS'
        '9049' = 'ROLE_LIST_FAILED'
        '9050' = 'ROLE_GET_SUCCESS'
        '9051' = 'ROLE_GET_FAILED'
        '9052' = 'ROLE_UPDATE_SUCCESS'
        '9053' = 'ROLE_UPDATE_FAILED'
        '9054' = 'ROLE_LIST_APPS_SUCCESS'
        '9055' = 'ROLE_LIST_APPS_FAILED'
        '9056' = 'ROLE_LIST_USERS_SUCCESS'
        '9057' = 'ROLE_LIST_USERS_FAILED'
        '9058' = 'ROLE_LIST_ADMINISTRATORS_SUCCESS'
        '9059' = 'ROLE_LIST_ADMINISTRATORS_FAILED'
    }
}

# Event Action Mappings
translate {
    src = 'event.code'
    dest = 'event.action'
    default = 'unknown'
    map = {
        'APP_ADDED_TO_ROLE' = 'update_role'
        'APP_REMOVED_FROM_ROLE' = 'update_role'
        'USER_ASSUMED_USER' = 'impersonate_user'
        'USER_ASSIGNED_ROLE' = 'add_role'
        'USER_LOGGED_INTO_ONELOGIN' = 'login_user'
        'USER_FAILED_ONELOGIN_LOGIN' = 'login_user'
        'USER_LOGGED_OUT_OF_ONELOGIN' = 'logout_user'
        'USER_LOGGED_INTO_APP' = 'access_app'
        'USER_FAILED_APP_LOGIN' = 'access_app'
        'USER_REQUESTED_NEW_PASSWORD' = 'reset_password'
        'USER_CHANGED_PASSWORD' = 'update_password'
        'UNLOCKED_USER' = 'unlock_user'
        'CREATED_USER' = 'create_user'
        'UPDATED_USER' = 'update_user'
        'DEACTIVATED_USER' = 'disable_user'
        'ACTIVATED_USER' = 'enable_user'
        'DELETED_USER' = 'delete_user'
        'ADMIN_APPROVED_PASSWORD_REQUEST' = 'approve_request'
        'USER_LOCKED' = 'lock_user'
        'REACHED_USERS_LIMIT' = 'alert_user'
        'SUSPENDED_USER' = 'disable_user'
        'USER_ADDED_OTP_DEVICE' = 'add_mfa'
        'USER_BULK_OPERATION' = 'update_user'
        'USER_REMOVED_OTP_DEVICE' = 'remove_mfa'
        'PROVISIONING_EXCEPTION' = 'alert_event'
        'PROVISIONING_EVENT' = 'create_user'
        'USER_DOWNLOADED_CERT' = 'download_resource' # download_resource?
        'USER_RECENTLY_REMOVED' = 'remove_user' # remove_user?
        'USER_LOGGED_OUT_OF_APP' = 'logout_user'
        'UPDATED_PAYMENT_INFO' = 'update_resource' # update_resource?
        'FAILED_UPDATE_PAYMENT_INFO' = 'update_resource' # update_resource?
        'REACTIVATED_USER' = 'enable_user'
        'USERS_IMPORTED_FROM_DIRECTORY' = 'import_user'
        'USER_REQUESTED_APP' = 'request_access'
        'USER_LOCKED_OUT_OF_APP' = 'lock_user'
        'USER_LOST_OTP_DEVICE' = 'remove_mfa' # remove_mfa?
        'USER_JOIN_REQUEST' = 'request_access'
        'APP_REACHED_USER_LIMIT' = 'alert_event'
        'CONNECTOR_BROKEN' = 'alert_event'
        'USER_UNLOCKED_OTP_DEVICE' = 'alert_mfa' # Not sure if it's jailbreaking device or something else
        'AD_CONNECTOR_STARTED' = 'enable_resource'
        'AD_CONNECTOR_STOPPED' = 'disable_resource'
        'AD_CONNECTOR_CONFIG_RELOAD' = 'update_setting'
        'AD_CONNECTOR_NOTIFICATION' = 'alert_event'
        'AD_CONNECTOR_EXCEPTION_OLD' = 'alert_event'
        'AD_CONNECTOR_FAIL_OVER' = 'alert_event'
        'AD_CONNECTOR_EXCEPTION' = 'alert_event'
        'IMPORTED_USER' = 'import_user'
        'UPDATE_USER_FAILED' = 'update_user'
        'REJECTED_USER' = 'block_user' # deny_request?
        'USER_CREATED_IN_APP' = 'create_user'
        'USER_UPDATED_IN_APP' = 'update_user'
        'USER_SUSPENDED_IN_APP' = 'disable_user'
        'USER_REACTIVATED_IN_APP' = 'enable_user'
        'USER_DELETED_IN_APP' = 'delete_user'
        'UNMATCHED_USERS' = 'alert_event'
        'RABBIT_DOWN' = 'alert_event'
        'RABBIT_RESTARTED' = 'enable_resource'
        'USER_LINKED_IN_APP' = 'connect_user'
        'PROVISIONING_DEPROVISIONING_MODE_DO_NOTHING_WARNING' = 'alert_event'
        'USER_FAILED_SUSPENDING_IN_APP' = 'disable_user'
        'USER_FAILED_REACTIVATING_IN_APP' = 'enable_user'
        'USER_FAILED_DELETING_IN_APP' = 'delete_user'
        'USER_FAILED_CREATING_IN_APP' = 'create_user'
        'USER_FAILED_UPDATING_IN_APP' = 'update_user'
        'NO_USERS_TO_IMPORT_FROM_DIRECTORY' = 'alert_event'
        'DIRECTORY_IMPORT_EXCEPTION' = 'alert_event'
        'USER_AUTHENTICATED_BY_RADIUS' = 'authenticate_user'
        'USER_REJECTED_BY_RADIUS' = 'block_user' # should this be authenticate_user + outcome:"failure" instead?
        'PRIVILEGE_GRANTED_TO_ACCOUNT' = 'add_permission'
        'PRIVILEGE_REVOKED_FROM_ACCOUNT' = 'remove_permission'
        'PRIVILEGE_GRANTED_TO_USER' = 'add_permission'
        'PRIVILEGE_REVOKED_FROM_USER' = 'remove_permission'
        'TRUSTED_IDP_ADDED' = 'create_resource'
        'TRUSTED_IDP_REMOVED' = 'delete_resource'
        'TRUSTED_IDP_MODIFIED' = 'update_resource'
        'USER_FAILED_PROXY_LOGIN' = 'login_user'
        'USER_SUCCEEDED_PROXY_LOGIN' = 'login_user'
        'AD_CONNECTOR_PROVISIONING_ERROR' = 'alert_event'
        'USER_CREATED_IN_DIRECTORY' = 'create_user'
        'USER_UPDATED_IN_DIRECTORY' = 'update_user'
        'USER_SUSPENDED_IN_DIRECTORY' = 'disable_user'
        'USER_REACTIVATED_IN_DIRECTORY' = 'enable_user'
        'USER_DELETED_IN_DIRECTORY' = 'delete_user'
        'APP_COULD_NOT_AUTHENTICATE' = 'authenticate_app'
        'USER_FAILED_REMOTE_AUTHENTICATION' = 'login_user' # ?
        'USER_VIEWED_NOTE' = 'read_resource'
        'USER_EDITED_NOTE' = 'update_resource'
        'USER_DELETED_NOTE' = 'delete_resource'
        'USER_UNAUTHORIZED_APP_ACCESS' = 'deny_access'
        'USER_UNDETERMINED_BY_RADIUS' = 'alert_event'
        'USER_NTHASH_REQUESTED_BY_RADIUS' = 'alert_event'
        'DIRECTORY_GROUPS_WRITE_BACK_IMPORT_STARTED' = 'execute_workflow'
        'DIRECTORY_GROUPS_WRITE_BACK_IMPORT_FINISHED' = 'complete_workflow'
        'SELF_REGISTRATION_REQUEST' = 'request_access'
        'SELF_REGISTRATION_APPROVED' = 'approve_request'
        'SELF_REGISTRATION_DENIED' = 'deny_request'
        'SELF_REGISTRATION_REQUEST_UNVERIFIED' = 'alert_event'
        'SELF_REGISTRATION_REQUEST_VERIFIED' = 'verify_user'
        'SMS_FAILURE' = 'alert_event'
        'USER_CHANGE_PASSWORD_FAILED' = 'update_password'
        'APP_LOGINS_UPDATED' = 'update_app'
        'APP_LOGINS_UPDATE_FAILED' = 'alert_event'
        'TRUSTED_IDP_MADE_DEFAULT' = 'update_setting'
        'DIRECTORY_IMPORT_STARTED' = 'execute_workflow'
        'DIRECTORY_IMPORT_FINISHED' = 'complete_workflow'
        'USER_INVITED' = 'invite_user'
        'CREATE_USER_FAILED' = 'create_user'
        'DIRECTORY_SYNC_RUN_ID' = 'read_resource'
        'SAML_ACS_FAILED' = 'authenticate_app'
        'TRUSTED_IDP_REMOVED_AS_DEFAULT' = 'update_setting'
        'UNLOCKED_USER_IN_DIRECTORY' = 'unlock_user'
        'SCRIPTLET_ERROR' = 'alert_event'
        'USER_AUTHENTICATED_BY_API' = 'authenticate_user'
        'USER_REJECTED_BY_API' = 'deny_request'
        'ENTITLEMENTS_CACHE_ACTION' = 'update_resource'
        'ENTITLEMENT_ACTION' = 'update_resource'
        'DIRECTORY_CONNECTOR_ENABLED' = 'enable_resource'
        'DIRECTORY_CONNECTOR_DISABLED' = 'disable_resource'
        'NO_ACTIVE_ACTIVE_DIRECTORY_CONNECTORS' = 'alert_event'
        'VLDAP_BIND_FAILURE' = 'alert_event'
        'VLDAP_BIND_SUCCESS' = 'enable_resource'
        'DIRECTORY_EXPORT_STARTED' = 'download_resource' # ?
        'DIRECTORY_EXPORT_FINISHED' = 'download_resource' # ?
        'DIRECTORY_EXPORT_EXCEPTION' = 'alert_event'
        'DIRECTORY_REFRESH_SCHEMA_EXCEPTION' = 'alert_event'
        'CERTIFICATE_EXPIRES' = 'alert_event'
        'DIRECTORY_FIELDS_IMPORT_STARTED' = 'execute_workflow'
        'USER_APP_REQUEST_APPROVED' = 'approve_request'
        'USER_APP_REQUEST_DENIED' = 'deny_request'
        'DIRECTORY_FIELDS_IMPORT_FINISHED' = 'complete_workflow'
        'SOCIAL_SIGN_IN' = 'login_user'
        'SOCIAL_SIGN_IN_FAILURE' = 'login_user'
        'USER_SMART_PASSWORD_UPDATED' = 'update_password'
        'USER_SMART_PASSWORD_UPDATE_FAILED' = 'update_password'
        'USER_MANUALLY_ADDED_TO_ROLE' = 'add_role' # ?
        'USER_MANUALLY_REMOVED_FROM_ROLE' = 'remove_role' # ?
        'USER_AUTO_ADDED_TO_ROLE' = 'add_role' # ?
        'USER_AUTO_REMOVED_FROM_ROLE' = 'remove_role' # ?
        'USER_ROLE_MANAGEMENT_GRANTED' = 'approve_user'
        'USER_ROLE_MANAGEMENT_REVOKED' = 'revoke_user'
        'MAC_LOGIN_SUCCESS' = 'login_user'
        'MAC_LOGIN_FAILURE' = 'login_user'
        'DIRECTORY_FIELDS_IMPORT_EXCEPTION' = 'alert_event'
        'POLICY_CREATED' = 'create_policy'
        'POLICY_UPDATED' = 'update_policy'
        'POLICY_DELETED' = 'delete_policy'
        'PROXY_AGENT_CREATED' = 'create_resource'
        'PROXY_AGENT_DELETED' = 'delete_resource'
        'RADIUS_CONFIG_CREATED' = 'create_resource'
        'RADIUS_CONFIG_UPDATED' = 'update_resource'
        'RADIUS_CONFIG_DELETED' = 'delete_resource'
        'VPN_ENABLED' = 'enable_resource'
        'VPN_SETTINGS_UPDATED' = 'update_resource'
        'VPN_DISABLED' = 'disable_resource'
        'EMBEDDING_ENABLED' = 'enable_resource'
        'EMBEDDING_SETTINGS_UPDATED' = 'update_resource'
        'EMBEDDING_DISABLED' = 'disable_resource'
        'AUTHENTICATION_FACTOR_CREATED' = 'create_mfa' # ?
        'AUTHENTICATION_FACTOR_UPDATED' = 'change_mfa' # ?
        'AUTHENTICATION_FACTOR_DELETED' = 'remove_mfa' # ?
        'SECURITY_QUESTIONS_UPDATED' = 'update_resource'
        'DESKTOP_SSO_SETTINGS_UPDATED' = 'update_setting'
        'DESKTOP_SSO_ENABLED' = 'enable_resource'
        'DESKTOP_SSO_DISABLED' = 'disable_resource'
        'CERTIFICATE_CREATED' = 'enroll_certificate' # ?
        'CERTIFICATE_DELETED' = 'delete_certificate'
        'API_CREDENTIAL_CREATED' = 'create_api'
        'API_CREDENTIAL_DELETED' = 'revoke_api'
        'API_CREDENTIAL_ENABLED' = 'enable_api'
        'API_CREDENTIAL_DISABLED' = 'revoke_api'
        'VLDAP_ENABLED' = 'enable_setting'
        'VLDAP_DISABLED' = 'disable_setting'
        'VLDAP_SETTINGS_UPDATED' = 'update_setting'
        'BRANDING_ENABLED' = 'enable_setting'
        'BRANDING_DISABLED' = 'disable_setting'
        'BRANDING_UPDATED' = 'update_setting'
        'MAPPING_ADDED' = 'create_resource'
        'MAPPING_DELETED' = 'delete_resource'
        'MAPPING_DISABLED' = 'disable_resource'
        'MAPPING_ENABLED' = 'enable_resource'
        'MAPPING_UPDATED' = 'update_resource'
        'USER_FIELD_ADDED' = 'create_metadata'
        'USER_FIELD_DELETED' = 'delete_metadata'
        'COMPANY_INFO_UPDATED' = 'update_organization'
        'ACCOUNT_SETTINGS_UPDATED' = 'update_account'
        'DIRECTORY_CREATED' = 'create_resource'
        'DIRECTORY_DESTROYED' = 'delete_resource'
        'DIRECTORY_CONNECTOR_INSTANCE_ADDED' = 'create_resource'
        'DIRECTORY_CONNECTOR_INSTANCE_DELETED' = 'delete_resource'
        'REAPPLIED_MAPPINGS' = 'update_resource'
        'SELF_REGISTRATION_PROFILE_CREATED' = 'create_user'
        'SELF_REGISTRATION_PROFILE_UPDATED' = 'update_user'
        'SELF_REGISTRATION_PROFILE_DESTROYED' = 'delete_user'
        'MANUALLY_ADDED_LOGIN' = 'update_user'
        'MANUALLY_REMOVED_LOGIN' = 'update_user'
        'RETRIED_PROVISIONING' = 'create_user'
        'DIRECTORY_USER_IMPORT_WARNING' = 'alert_event'
        'LDAP_CONNECTOR_EXCEPTION' = 'alert_event'
        'ADMIN_CHANGED_USER_PASSWORD' = 'update_password' # Do we use the same event.action for admin changing someones pw vs user changing their own?
        'DIRECTORY_LOCKED' = 'disable_resource'
        'PROFILE_PICTURE_UPLOADED' = 'update_user'
        'PROFILE_PICTURE_DELETED' = 'update_user'
        'ADMIN_CHANGED_ACCOUNT_SETTINGS' = 'update_account'
        'JOB_IN_QUEUE' = 'alert_event'
        'DIRECTORY_IMPORT_LIMIT_REACHED' = 'alert_event'
        'REAPPLIED_MAPPINGS_FAILED' = 'alert_event'
        'WORKDAY_REAL_TIME_NOTIFICATION' = 'notify_workflow'
        'ADMIN_CREATED_PAYMENT_RECORD' = 'create_resource'
        'ADMIN_UPDATED_PAYMENT_RECORD' = 'update_resource'
        'ADMIN_DELETED_PAYMENT_RECORD' = 'delete_resource'
        'USER_UNLICENSED' = 'disable_user'
        'USER_LICENSED_MANUALLY' = 'enable_user'
        'USER_UNLICENSED_MANUALLY' = 'disable_user'
        'USER_UNLICENSED_AUTOMATICALLY' = 'disable_user'
        'USER_LICENSE_FAILED' = 'enable_user'
        'USERS_LICENSED_BULK' = 'enable_user'
        'ACCOUNT_NEAR_LIMIT' = 'alert_event'
        'ACCOUNT_IN_LIMIT' = 'alert_event'
        'USERS_IN_UNLICENSED_STATE' = 'alert_event'
        'USER_AGREED_TERMS' = 'accept_tos'
        'USER_DENIED_TERMS' = 'deny_request'
        'ADMIN_ENABLED_TERMS' = 'update_setting'
        'ADMIN_UPDATED_TERMS' = 'update_setting'
        'ADMIN_DISABLED_TERMS' = 'disable_resource'
        'DELETE_USER_FAILED' = 'delete_user'
        'USER_REDIRECTED_FOR_PASSWORD_CHANGE' = 'reset_password'
        'IMPORT_USER_FAILED' = 'import_user'
        'USER_REVEALED_PASSWORD' = 'read_password'
        'CSV_IMPORT_FAILED' = 'alert_event'
        'JOB_START_FAILED' = 'alert_event'
        'JOB_TERMINATED' = 'cancel_workflow'
        'REPORT_GENERATED' = 'create_resource'
        'REPORT_GENERATION_FAILED' = 'alert_event'
        'REPORT_GENERATION_TERMINATED' = 'cancel_workflow'
        'USER_MAPPINGS_FAILED' = 'update_resource'
        'USER_MAPPINGS_SUCCEEDED' = 'update_resource'
        'USER_BULK_OPERATION_FAILED' = 'update_resource'
        'PROVISIONING_APP_CONFIG_ERROR' = 'alert_event'
        'PROVISIONING_APP_THROTTLED' = 'alert_event'
        'USER_REMOVELOGINS_FAILED' = 'alert_event'
        'ENTITLEMENT_MAPPINGS_FAILED' = 'update_resource'
        'ENTITLEMENT_MAPPINGS_REAPPLIED' = 'update_resource'
        'MANUALLY_UPDATED_LOGIN' = 'update_user'
        'USER_CREATED_BY_TIDP' = 'create_user'
        'LDAP_CONNECTOR_STARTED' = 'enable_resource'
        'LDAP_CONNECTOR_NOTIFICATION' = 'alert_event'
        'LDAP_CONNECTOR_CONFIG_RELOAD' = 'update_setting'
        'LDAP_CONNECTOR_STOPPED' = 'disable_resource'
        'LDAP_CONNECTOR_FAIL_OVER' = 'alert_event'
        'MANUALLY_ADDED_LOGIN_FAILURE' = 'alert_event'
        'LDAP_CONNECTOR_PROVISIONING_ERROR' = 'alert_event'
        'USER_DISASSOCIATED_FROM_DIRECTORY' = 'remove_user'
        'USER_ASSOCIATED_TO_DIRECTORY' = 'add_user'
        'USER_DIRECTORY_EXTERNAL_ID_UPDATED' = 'update_user'
        'USER_DIRECTORY_EXTERNAL_ID_DELETED' = 'delete_metadata'
        'USER_NOT_UPDATED_IN_APP' = 'update_resource'
        'API_BAD_REQUEST' = 'alert_api'
        'API_UNAUTHORIZED' = 'alert_api'
        'MAPPING_SKIPPED' = 'alert_api'
        'BROADCASTER_CREATED' = 'create_resource'
        'BROADCASTER_UPDATED' = 'update_resource'
        'BROADCASTER_DELETED' = 'delete_resource'
        'API_BAD_REQUEST' = 'alert_api'
        'API_UNAUTHORIZED' = 'alert_api'
        'MAPPING_SKIPPED' = 'alert_event'
        'API_INDEX_ACTION' = 'query_api'
        'API_SHOW_ACTION' = 'query_api'
        'API_RES_ACTION' = 'query_resource'
        'API_SET_PWD_SALT' = 'update_password'
        'API_SET_PWD_CLEAR_TEXT' = 'update_password'
        'API_SET_CUSTOM_ATTRS' = 'update_resource'
        'API_ADD_ROLES' = 'add_role'
        'API_REMOVE_ROLES' = 'remove_role'
        'API_AUTH_ISSUE_TOKEN' = 'create_token'
        'API_LOGOUT' = 'logout_user' # ?
        'API_SET_PWD_SALT_FAILED' = 'alert_api'
        'API_SET_PWD_CLEAR_TEXT_FAILED' = 'alert_api'
        'API_SET_CUSTOM_ATTRS_FAILED' = 'alert_api'
        'API_ADD_ROLES_FAILED' = 'add_role'
        'API_REMOVE_ROLES_FAILED' = 'remove_role'
        'API_AUTH_ISSUE_TOKEN_FAILED' = 'alert_api'
        'API_LOGOUT_FAILED' = 'logout_user'
        'API_DESTROY_USER_FAILED' = 'delete_user'
        'API_GET_INVITE_LINK_FAILED' = 'alert_api'
        'API_LOCK_USER_FAILED' = 'lock_user'
        'API_VERIFY_FACTOR_FAILED' = 'alert_mfa'
        'API_VERIFY_FACTOR' = 'alert_mfa'
        'API_UPDATE_USER' = 'update_user'
        'API_DESTROY_USER' = 'delete_user'
        'API_LOCK_USER' = 'lock_user'
        'API_UPDATE_USER_FAILED' = 'update_user'
        'API_CREATE_USER' = 'create_user'
        'API_CREATE_USER_FAILED' = 'create_user'
        'API_GET_INVITE_LINK' = 'invite_user'
        'API_USER_OTPS_RETRIEVED' = 'read_resource'
        'API_CONFIRM_FACTOR' = 'verify_mfa'
        'API_CONFIRM_FACTOR_FAILED' = 'alert_mfa'
        'API_TRIGGER_FACTOR' = 'notify_mfa'
        'API_ADDED_OTP_DEVICE' = 'add_mfa'
        'DIRECTORY_UPDATED' = 'update_resource'
        'DIRECTORY_OUS_CHANGED' = 'update_resource'
        'API_SEND_INVITE_LINK_FAILED' = 'alert_api'
        'API_SEND_INVITE_LINK' = 'invite_user'
        'FORCE_LOGOUT_USER' = 'logout_user'
        'SUSPENDED_USER_VIA_API' = 'disable_user'
        'REACTIVATED_USER_VIA_API' = 'enable_user'
        'USER_LOCKED_VIA_API' = 'disable_user' # ACES difference between suspend and lock?
        'UNLOCKED_USER_VIA_API' = 'enable_user' # ACES difference between activate and unlock?
        'EXTERNAL_ASSUME_USER' = 'impersonate_user'
        'APP_CREATED_BY_USER' = 'enable_app'
        'APP_UPDATED_BY_USER' = 'update_app'
        'APP_DELETED_BY_USER' = 'disable_app'
        'CONNECTOR_CREATED' = 'create_resource'
        'CONNECTOR_CREATE_FAILED' = 'create_resource'
        'CONNECTOR_UPDATED' = 'update_resource'
        'CONNECTOR_UPDATE_FAILED' = 'update_resource'
        'CONNECTOR_DELETED' = 'delete_resource'
        'CONNECTOR_DELETE_FAILED' = 'delete_resource'
        'CONNECTOR_STATS_UPDATE' = 'update_resource'
        'PARAMETER_CREATED' = 'create_resource'
        'PARAMETER_CREATE_FAILED' = 'create_resource'
        'PARAMETER_UPDATED' = 'update_resource'
        'PARAMETER_UPDATE_FAILED' = 'update_resource'
        'PARAMETER_DELETED' = 'delete_resource'
        'PARAMETER_DELETE_FAILED' = 'delete_resource'
        'ONELOGIN_DESKTOP_MAC_LOGIN_SUCCESS' = 'login_user'
        'ONELOGIN_DESKTOP_MAC_LOGIN_FAILURE' = 'login_user'
        'ONELOGIN_DESKTOP_DEVICE_DELETED' = 'remove_device'
        'ONELOGIN_DESKTOP_DEVICE_UNBIND' = 'remove_device'
        'ONELOGIN_DESKTOP_LOGIN_SUCCESS' = 'login_user'
        'ONELOGIN_DESKTOP_LOGIN_FAILURE' = 'login_user'
        'ONELOGIN_DESKTOP_USER_FAILED_ONELOGIN_LOGIN' = 'login_user'
        'DIRECTORY_EXPORT_SUCCESS' = 'download_resource'
        'ONELOGIN_DESKTOP_REVOKE_CERT_FOR_USER' = 'revoke_certificate'
        'ONELOGIN_DESKTOP_REVOKE_CERT_FOR_DEVICE' = 'revoke_certificate'
        'ADAPTIVE_LOGIN_ENABLED' = 'enable_policy'
        'ADAPTIVE_LOGIN_DISABLED' = 'disable_policy'
        'OL_OTP_PUSH_REJECT' = 'verify_mfa'
        'USER_LOGIN_CHALLENGE' = 'notify_mfa'
        'USER_LOGIN_CHALLENGE_FAILED' = 'verify_mfa'
        'USER_REAUTH_SUCCESS' = 'authenticate_user'
        'TEMP_OTP_TOKEN_GENERATED' = 'create_mfa'
        'TEMP_OTP_TOKEN_REVOKED' = 'revoke_token'
        'DELEGATED_APP_PRIVILEGE_DENIED' = 'deny_access'
        'DELEGATED_USER_PRIVILEGE_DENIED' = 'deny_access'
        'USER_ADDED_PHONE_NUMBER' = 'update_user'
        'USER_UPDATED_PHONE_NUMBER' = 'update_user'
        'API_APP_CREATED' = 'create_app'
        'API_APP_CREATE_FAILED' = 'create_app'
        'API_APP_UPDATED' = 'update_app'
        'API_APP_UPDATE_FAILED' = 'update_app'
        'API_APP_DESTROYED' = 'delete_app'
        'API_APP_DESTROY_FAILED' = 'delete_app'
        'USER_VERIFIED_OTP_DEVICE' = 'verify_mfa'
        'API_AUTH_APP_CREATE_FAILED' = 'alert_api'
        'API_AUTH_APP_UPDATED' = 'update_app'
        'API_AUTH_APP_UPDATE_FAILED' = 'alert_api'
        'API_AUTH_APP_DESTROYED' = 'delete_app'
        'API_AUTH_APP_DESTROY_FAILED' = 'alert_api'
        'API_AUTH_SCOPE_CREATED' = 'create_resource'
        'API_AUTH_SCOPE_CREATE_FAILED' = 'alert_api'
        'API_AUTH_SCOPE_UPDATED' = 'update_resource'
        'API_AUTH_SCOPE_UPDATE_FAILED' = 'alert_api'
        'API_AUTH_SCOPE_DESTROYED' = 'delete_resource'
        'API_AUTH_SCOPE_DESTROY_FAILED' = 'alert_api'
        'API_AUTH_CLAIM_CREATED' = 'create_resource'
        'API_AUTH_CLAIM_CREATE_FAILED' = 'alert_api'
        'API_AUTH_CLAIM_UPDATED' = 'update_resource'
        'API_AUTH_CLAIM_UPDATE_FAILED' = 'alert_api'
        'API_AUTH_CLAIM_DESTROYED' = 'delete_resource'
        'API_AUTH_CLAIM_DESTROY_FAILED' = 'alert_api'
        'API_AUTH_CLIENT_CREATED' = 'create_resource'
        'API_AUTH_CLIENT_CREATE_FAILED' = 'alert_api'
        'API_AUTH_CLIENT_UPDATED' = 'update_resource'
        'API_AUTH_CLIENT_UPDATE_FAILED' = 'alert_api'
        'API_AUTH_CLIENT_DESTROYED' = 'delete_resource'
        'API_AUTH_CLIENT_DESTROY_FAILED' = 'alert_api'
        'API_AUTH_APP_CREATED' = 'create_app'
        'SANDBOX_SYNC_STARTED' = 'execute_workflow'
        'SANDBOX_SYNC_FAILED' = 'alert_event'
        'SANDBOX_SYNCED' = 'complete_workflow'
        'SANDBOX_DELETED' = 'delete_resource'
        'SANDBOX_DELETE_FAILED' = 'delete_resource'
        'SANDBOX_CREATED' = 'create_resource'
        'SANDBOX_CREATION_FAILED' = 'create_resource'
        'SANDBOX_UPDATED' = 'update_resource'
        'SANDBOX_UPDATE_FAILED' = 'update_resource'
        'SANDBOX_DELETED_BY_API' = 'delete_resource'
        'SANDBOX_DELETE_FAILED_BY_API' = 'delete_resource'
        'SANDBOX_CREATED_BY_API' = 'create_resource'
        'SANDBOX_CREATION_FAILED_BY_API' = 'create_resource'
        'SANDBOX_UPDATED_BY_API' = 'update_resource'
        'SANDBOX_UPDATE_FAILED_BY_API' = 'update_resource'
        'PROFILE_DEVICES_DELETE_DEVICE' = 'remove_device'
        'PROFILE_DEVICES_RENAME_DEVICE' = 'update_device'
        'PROFILE_DEVICES_UPDATE_DEFAULT' = 'change_mfa' # This is generated when setting another security factor (email) as default/primary for a user
        'PROFILE_SETTINGS_UPDATE_LOCALE' = 'update_user'
        'PROFILE_SETTINGS_UPDATE_PHONE' = 'update_user'
        'PROFILE_SETTINGS_UPDATE_DEFAULT_TAB' = 'update_user'
        'PROFILE_SETTINGS_UPDATE_PROFILE_PHOTO' = 'update_user'
        'PROFILE_SETTINGS_UPDATE_APP_AUTO_DETECT' = 'update_user'
        'PROFILE_CHANGE_PASSWORD' = 'update_password'
        'PROFILE_SETTINGS_UPDATE_SHOW_TABS' = 'update_user'
        'RADIUS_ATTRIBUTE_CREATED' = 'create_resource'
        'RADIUS_ATTRIBUTE_UPDATED' = 'update_resource'
        'RADIUS_ATTRIBUTE_DELETED' = 'delete_resource'
        'ROLE_CREATED' = 'create_role'
        'ROLE_DELETED' = 'delete_role'
        'API_BRAND_CREATED' = 'create_resource'
        'API_BRAND_CREATE_FAILED' = 'alert_api'
        'API_BRAND_UPDATED' = 'update_resource'
        'API_BRAND_UPDATE_FAILED' = 'alert_api'
        'API_BRAND_DESTROYED' = 'delete_resource'
        'API_BRAND_DESTROY_FAILED' = 'alert_api'
        'HOOKS_LIST_FUNCTION' = 'read_resource'
        'CUSTOM_SMTP_ERROR' = 'alert_event'
        'SMTP_SETTINGS_UPDATED' = 'update_setting'
        'HOOKS_CREATE_FUNCTION' = 'create_resource'
        'HOOKS_CREATE_FUNCTION_FAILED' = 'alert_api'
        'HOOKS_GET_FUNCTION' = 'read_resource'
        'HOOKS_GET_FUNCTION_LOGS' = 'read_resource'
        'HOOKS_UPDATE_FUNCTION' = 'update_resource'
        'HOOKS_UPDATE_FUNCTION_FAILED' = 'alert_api'
        'HOOKS_DELETE_FUNCTION' = 'delete_resource'
        'HOOKS_DELETE_FUNCTION_FAILED' = 'alert_api'
        'HOOKS_LIST_ENVVAR' = 'read_resource'
        'HOOKS_CREATE_ENVVAR' = 'create_resource'
        'HOOKS_CREATE_ENVVAR_FAILED' = 'alert_api'
        'HOOKS_GET_ENVVAR' = 'read_resource'
        'HOOKS_UPDATE_ENVVAR' = 'update_resource'
        'HOOKS_UPDATE_ENVVAR_FAILED' = 'alert_api'
        'HOOKS_DELETE_ENVVAR' = 'delete_resource'
        'HOOKS_DELETE_ENVVAR_FAILED' = 'alert_api'
        'DELEGATED_PRIVILEGE_CREATED_VIA_API' = 'create_resource'
        'DELEGATED_PRIVILEGE_CREATED_BY_USER' = 'create_resource'
        'DELEGATED_PRIVILEGE_UPDATED_VIA_API' = 'update_resource'
        'DELEGATED_PRIVILEGE_UPDATED_BY_USER' = 'update_resource'
        'DELEGATED_PRIVILEGE_DELETED_VIA_API' = 'delete_resource'
        'DELEGATED_PRIVILEGE_DELETED_BY_USER' = 'delete_resource'
        'DELEGATED_PRIVILEGE_ASSIGNED_TO_USER_VIA_API' = 'add_permission'
        'DELEGATED_PRIVILEGE_ASSIGNED_TO_USER_BY_USER' = 'add_permission'
        'DELEGATED_PRIVILEGE_REMOVED_FROM_USER_VIA_API' = 'remove_permission'
        'DELEGATED_PRIVILEGE_REMOVED_FROM_USER_BY_USER' = 'remove_permission'
        'DELEGATED_PRIVILEGE_ASSIGNED_TO_ROLE_VIA_API' = 'add_permission'
        'DELEGATED_PRIVILEGE_ASSIGNED_TO_ROLE_BY_USER' = 'add_permission'
        'DELEGATED_PRIVILEGE_REMOVED_FROM_ROLE_VIA_API' = 'remove_permission'
        'DELEGATED_PRIVILEGE_REMOVED_FROM_ROLE_BY_USER' = 'remove_permission'
        'DELEGATED_ROLE_PRIVILEGE_DENIED' = 'deny_access'
        'REPORT_CREATED_BY_USER' = 'create_resource'
        'REPORT_UPDATED_BY_USER' = 'update_resource'
        'REPORT_CLONED_BY_USER' = 'copy_resource'
        'REPORT_DESTROYED_BY_USER' = 'delete_resource'
        'OIDC_GENERAL_FAIL' = 'alert_api'
        'OIDC_IMPLICIT_FLOW_SUCCESS' = 'authenticate_user'
        'OIDC_IMPLICIT_FLOW_FAILED' = 'alert_api'
        'OIDC_GET_CODE_SUCCESS' = 'authenticate_user'
        'OIDC_GET_CODE_FAILED' = 'alert_api'
        'OIDC_AUTHORIZATION_CODE_SUCCESS' = 'authenticate_user'
        'OIDC_AUTHORIZATION_CODE_FAILED' = 'alert_api'
        'OIDC_CLIENT_CREDENTIALS_SUCCESS' = 'authenticate_app'
        'OIDC_CLIENT_CREDENTIALS_FAILED' = 'alert_api'
        'OIDC_PASSWORD_SUCCESS' = 'authenticate_user'
        'OIDC_PASSWORD_FAILED' = 'alert_api'
        'OIDC_REFRESH_TOKEN_SUCCESS' = 'update_token'
        'OIDC_REFRESH_TOKEN_FAILED' = 'alert_api'
        'OIDC_VALIDATE_TOKEN_SUCCESS' = 'evaluate_token'
        'OIDC_VALIDATE_TOKEN_FAILED' = 'alert_api'
        'OIDC_REVOKE_TOKEN_SUCCESS' = 'revoke_token'
        'OIDC_REVOKE_TOKEN_FAILED' = 'alert_api'
        'OIDC_USER_INFO_SUCCESS' = 'read_user'
        'OIDC_USER_INFO_FAILED' = 'alert_api'
        'NOTIFICATION_WAS_SENT' = 'notify_workflow'
        'GROUP_CREATED' = 'create_group'
        'GROUP_UPDATED' = 'update_group'
        'GROUP_DESTROYED' = 'delete_group'
        'USER_CREATED_NOTE' = 'create_resource'
        'DELEGATED_GROUP_PRIVILEGE_DENIED' = 'deny_access'
        'DELEGATED_POLICY_PRIVILEGE_DENIED' = 'deny_access'
        'PROFILE_DEVICES_UNSET_DEFAULT' = 'update_device'
        'DELEGATED_REPORT_PRIVILEGE_DENIED' = 'deny_access'
        'DELEGATED_TRUSTED_IDP_PRIVILEGE_DENIED' = 'deny_access'
        'USER_ENABLED_WORKFLOW' = 'enable_resource'
        'USER_DISABLED_WORKFLOW' = 'disable_resource'
        'USER_INITIATED_WORKFLOW' = 'create_workflow'
        'USER_COMPLETED_TASK' = 'complete_task'
        'USER_MARKED_TASK_COMPLETE' = 'complete_task'
        'USER_MARKED_WORKFLOW_COMPLETE' = 'complete_workflow'
        'USER_MARKED_TASK_INCOMPLETE' = 'update_task'
        'USER_ENABLED_ONBOARDING' = 'enable_resource'
        'USER_DISABLED_ONBOARDING' = 'disable_resource'
        'USER_ENABLED_OFFBOARDING' = 'enable_resource'
        'USER_DISABLED_OFFBOARDING' = 'disable_resource'
        'USER_INITIATED_OFFBOARDING' = 'create_workflow'
        'USER_INITIATED_ONBOARDING' = 'create_workflow'
        'USER_COMPLETED_WORKFLOW' = 'complete_workflow'
        'APP_RULES_LIST_SUCCESS' = 'read_resource'
        'APP_RULES_LIST_FAILED' = 'alert_event'
        'APP_RULES_CREATE_SUCCESS' = 'create_rule'
        'APP_RULES_CREATE_FAILED' = 'alert_event'
        'APP_RULES_UPDATE_SUCCESS' = 'update_rule'
        'APP_RULES_UPDATE_FAILED' = 'alert_event'
        'APP_RULES_GET_SUCCESS' = 'read_resource'
        'APP_RULES_GET_FAILED' = 'alert_event'
        'APP_RULES_DRYRUN_SUCCESS' = 'execute_rule'
        'APP_RULES_DRYRUN_FAILED' = 'alert_event'
        'APP_RULES_DELETE_SUCCESS' = 'delete_rule'
        'APP_RULES_DELETE_FAILED' = 'alert_event'
        'APP_RULES_SORT_SUCCESS' = 'update_rule'
        'APP_RULES_SORT_FAILED' = 'alert_event'
        'APP_RULES_APPLY_SUCCESS' = 'execute_rule'
        'APP_RULES_APPLY_FAILED' = 'alert_event'
        'APP_RULES_REFRESH_ENTITLEMENTS_SUCCESS' = 'synchronize_resource'
        'APP_RULES_REFRESH_ENTITLEMENTS_FAILED' = 'alert_event'
        'APP_RULES_LIST_CONDITIONS_SUCCESS' = 'read_resource'
        'APP_RULES_LIST_CONDITIONS_FAILED' = 'alert_event'
        'APP_RULES_LIST_CONDITION_OPERATORS_SUCCESS' = 'read_resource'
        'APP_RULES_LIST_CONDITION_OPERATORS_FAILED' = 'alert_event'
        'APP_RULES_LIST_ACTIONS_SUCCESS' = 'read_resource'
        'APP_RULES_LIST_ACTIONS_FAILED' = 'alert_event'
        'APP_RULES_LIST_ACTION_VALUES_SUCCESS' = 'read_resource'
        'APP_RULES_LIST_ACTION_VALUES_FAILED' = 'alert_event'
        'USER_ROLE_MANAGEMENT_GRANTED_FAILED' = 'alert_event'
        'USER_ROLE_MANAGEMENT_REVOKED_FAILED' = 'alert_event'
        'APP_ADDED_TO_ROLE_FAILED' = 'alert_event'
        'APP_REMOVED_FROM_ROLE_FAILED' = 'alert_event'
        'USER_MANUALLY_ADDED_TO_ROLE_FAILED' = 'alert_event'
        'USER_MANUALLY_REMOVED_FROM_ROLE_FAILED' = 'alert_event'
        'ROLE_CREATE_FAILED' = 'create_role'
        'ROLE_DELETE_FAILED' = 'delete_role'
        'ROLE_LIST_SUCCESS' = 'read_resource' # list = read ?
        'ROLE_LIST_FAILED' = 'alert_event' # list = read ?
        'ROLE_GET_SUCCESS' = 'read_role' # get = read ?
        'ROLE_GET_FAILED' = 'read_role' # get = read ?
        'ROLE_UPDATE_SUCCESS' = 'update_role'
        'ROLE_UPDATE_FAILED' = 'update_role'
        'ROLE_LIST_APPS_SUCCESS' = 'read_resource'
        'ROLE_LIST_APPS_FAILED' = 'alert_event'
        'ROLE_LIST_USERS_SUCCESS' = 'read_resource'
        'ROLE_LIST_USERS_FAILED' = 'alert_event'
        'ROLE_LIST_ADMINISTRATORS_SUCCESS' = 'read_resource'
        'ROLE_LIST_ADMINISTRATORS_FAILED' = 'alert_event'
    }
}

# Basic Event Parsing
rename { src = 'raw_event_data.id', dest = 'event.id'}
rename { src = 'raw_event_data.app_name', dest = 'application.name'}
rename { src = 'raw_event_data.app_id', dest = 'application.id'}
convert { src = 'application.id', type = 'str'}
rename { src = 'raw_event_data.error_description', dest = 'error.message'}

# Event Outcome Parsing
date { src = 'raw_event_data.created_at' }
parse_ip { src = 'raw_event_data.ipaddr', dest = 'source' }

if ( 'event.code' contains 'FAIL' or 'event.code' contains 'REJECT' ) {
    set { dest = 'event.outcome', value = 'failure' }
}
if ( 'event.code' == 'APP_COULD_NOT_AUTHENTICATE' ) {
    set { dest = 'event.outcome', value = 'failure' }
}
if ( 'event.code' == 'USER_UNAUTHORIZED_APP_ACCESS' ) {
    set { dest = 'event.outcome', value = 'failure' }
}
if ( 'event.outcome' != 'failure' ) {
    set { dest = 'event.outcome', value = 'success' }
}

# Authentication Parsing
# 224 notes"":""Authentication method: OTP (invalid OTP).""
# 1806 notes"":""Authentication method: password (invalid password).""
if ('event.code' contains 'USER_FAILED_ONELOGIN_LOGIN') {
    regex_capture {
        src = 'raw_event_data.notes'
        dest = 'temp_method_reason'
        regex = 'Authentication method:\s*([^\(]+)\s*\((.*?)\)'
    }
    copy { src = 'temp_method_reason.[0].[0]', dest = 'authentication.raw_method'}
    copy { src = 'temp_method_reason.[1].[0]', dest = 'event.reason'}
    del { src = 'temp_method_reason' }
}

if ('event.code' == 'USER_LOGGED_INTO_ONELOGIN') {
    regex_capture {
        src = 'raw_event_data.notes'
        dest = 'temp_method_reason'
        regex = 'Authentication method:\s*(.*)$'
    }
    copy { src = 'temp_method_reason.[0].[0]', dest = 'authentication.raw_method'}
    del { src = 'temp_method_reason' }
}

translate {
    src = 'authentication.raw_method'
    dest = 'authentication.method'
    map = {
        'OTP' = 'software_authenticator'
        'password' = 'password'
    }
}

# User Parsing
# Per https://developers.onelogin.com/api-docs/1/events/event-resource
# First and last name of the user that was acted upon to trigger the event.
# If their first and last name user attributes are empty, the element will instead return the users email address.
if ( 'raw_event_data.user_name' exists and 'raw_event_data.user_name' contains '@') {
    copy { src = 'raw_event_data.user_name', dest = 'user.target.email' }
}
if ( 'raw_event_data.user_name' exists and 'raw_event_data.user_name' not contains '@') {
    copy { src = 'raw_event_data.user_name', dest = 'user.target.full_name' }
}
copy { src = 'raw_event_data.user_name', dest = 'user.target.name' }
if ( 'raw_event_data.actor_user_name' exists and 'raw_event_data.actor_user_name' contains '@') {
    copy { src = 'raw_event_data.actor_user_name', dest = 'user.email' }
}
if ( 'raw_event_data.actor_user_name' exists and 'raw_event_data.actor_user_name' not contains '@') {
    copy { src = 'raw_event_data.actor_user_name', dest = 'user.full_name' }
}
copy { src = 'raw_event_data.actor_user_name', dest = 'user.name' }

copy { src = 'raw_event_data.actor_user_id', dest = 'user.id' }
copy { src = 'raw_event_data.user_id', dest = 'user.target.id' }

# Granular Event Parsing & Conditions
if ('event.code' == 'SAML_ACS_FAILED') {
    #copy { src = 'raw_event_data.notes', dest = 'event.reason'}
    regex_capture {
        src = 'raw_event_data.notes'
        dest = 'temp_reason'
        regex = '(Assertion Consumer Service URL not whitelisted)'
    }
    copy { src = 'temp_reason.[0].[0]', dest = 'event.reason'}
    del { src = 'temp_reason' }
}

if ( 'raw_event_data.notes' == 'No Access to App' ) {
    copy { src = 'raw_event_data.notes', dest = 'event.reason'}
}

if ( 'event.action' contains 'role' ) {
    copy { src = 'raw_event_data.role_name', dest = 'resource.name' }
    copy { src = 'raw_event_data.role_id', dest = 'resource.id' }
}

if ( 'event.action' contains 'group' ) {
    copy { src = 'raw_event_data.group_name', dest = 'resource.name' }
    copy { src = 'raw_event_data.group_id', dest = 'resource.id' }
}

if ( 'event.action' contains 'policy' ) {
    copy { src = 'raw_event_data.policy_name', dest = 'policy.name' }
    copy { src = 'raw_event_data.policy_id', dest = 'policy.id' }
    copy { src = 'raw_event_data.policy_type', dest = 'policy.category' }
}

if ( 'event.action' contains '_mfa' ) {
    copy { src = 'raw_event_data.otp_device_name', dest = 'resource.name' }
    copy { src = 'raw_event_data.otp_device_id', dest = 'resource.id' }
}

if ( 'event.action' contains '_app' ) {
    copy { src = 'application.name', dest = 'resource.name' }
    copy { src = 'application.id', dest = 'resource.id' }
}

if ('event.code' == 'UPDATED_USER' and 'raw_event_data.notes' contains 'changed Policy') {
    #copy { src = 'raw_event_data.notes', dest = 'event.reason'}
    regex_capture {
        src = 'raw_event_data.notes'
        dest = 'temp_policy'
        regex = 'changed Policy to (.*?)\s*$'
    }
    copy { src = 'temp_policy.[0].[0]', dest = 'policy.name'}
    del { src = 'temp_policy' }
}

if ('event.code' == 'UPDATED_USER' and 'raw_event_data.notes' == 'Updated: Email') {
    set { dest = 'labels.field', value = 'primary_email' }
}

if ( 'raw_event_data.notes' contains 'Password reset via Email requested' ) {
    set { dest = 'labels.reset_method', value = 'email' }
}
